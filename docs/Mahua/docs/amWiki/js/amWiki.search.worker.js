!function(t){"use strict";var e=function(){var t=function(){this._documents=null,this._processing={},this._data={titleScore:100,apiScore:50,textScore:5}};return t.prototype.initDocs=function(t){this._documents=t;for(var e in this._documents)this._documents.hasOwnProperty(e)&&this._preDoc(this._documents[e])},t.prototype._preDoc=function(t){t.content=t.content.replace(/^\s+|\s+$/g,"").replace(/^#\s?(.*?)[\r|\n]/,function(e,s){return t.title=s,""}).replace(/([^#]#{3} *\u8bf7\u6c42\u5730\u5740[\n\r]{1,4})([-\w:\/\.]+?)[\n\r]{1,}(#{3} *\u8bf7\u6c42\u7c7b\u578b[\s\S]+?#{3} *\u8bf7\u6c42\u53c2\u6570)/,function(e,s,n,i){return t.api=n,s+i}).replace(/#{1,6}(.*?)#{0,6}\s*[\r\n]/g,"$1").replace(/[_\*~]{1,2}(.*?)[_\*~]{1,2}/g,"$1").replace(/!\[.*?]\(.*?\)/g,"").replace(/\[(.*?)]\(.*?\)/g,"$1").replace(/`{3}.*?[\n\r]([\s\S]*?)`{3}/g,"$1").replace(/`(.*?)`/g,"$1").replace(/<.+?>/g,"").replace(/> *(.+?)[n\r]/g,"$1").replace(/-{3,} *[\n\r]/g,"").replace(/(\|.*?[\n\r]{1,2}){3,}/g,function(t){return t.replace(/\|.*?[\n\r]{1,2}/g,function(t){return t.indexOf("---")>=0?"":t.replace(/\|/g,"")})}).replace(/[\n\r\t]/g," ").replace(/\s{2,}/g," ")},t.prototype._addPorcessing=function(t,e,s){"undefined"==typeof this._processing[t]?(this._processing[t]={},this._processing[t][e]=s):"undefined"==typeof this._processing[t][e]?this._processing[t][e]=s:this._processing[t][e]+=s},t.prototype.matchWords=function(t){var e=new RegExp(t,"gi");for(var s in this._documents)if(this._documents.hasOwnProperty(s)){if(this._documents[s].title){var n=this._documents[s].title.match(e);if(n&&n.length>0){var i=this._documents[s].title.replace(e,function(t){return"<mark>"+t+"</mark>"});this._addPorcessing(s,"title",i),this._addPorcessing(s,"score",this._data.titleScore)}}if(this._documents[s].api){this._documents[s].api.match(e);if(n&&n.length>0){var r='<p class="p1"><em>\u63a5\u53e3</em>'+this._documents[s].api.replace(e,function(t){return"<mark>"+t+"</mark>"})+"</p>";this._addPorcessing(s,"api",r),this._addPorcessing(s,"score",this._data.apiScore)}}var o=this._documents[s].content.match(new RegExp(".{0,15}"+t+".{0,30}","gi"));if(o){for(var c,p="<p>",a=0;c=o[a];a++)a<2&&(p+=c.replace(e,function(t){return"<mark>"+t+"</mark>"})+"... ");p+="</p>",this._addPorcessing(s,"content",p),this._addPorcessing(s,"score",o.length*this._data.textScore)}}this._auxiliary()},t.prototype._auxiliary=function(){},t.prototype._sortByScore=function(){var t=[];for(var e in this._processing)this._processing.hasOwnProperty(e)&&("undefined"==typeof this._processing[e].title&&(this._processing[e].title=this._documents[e].title?this._documents[e].title:""),"undefined"==typeof this._processing[e].api&&(this._processing[e].api=""),"undefined"==typeof this._processing[e].content&&(this._processing[e].content="<p>"+this._documents[e].content.substr(0,45)+"...</p>"),this._processing[e].path=this._documents[e].uri,this._processing[e].timestamp=this._documents[e].timestamp,t.push(this._processing[e]));return t.sort(function(t,e){return t.score>e.score?-1:1}),t},t.prototype.getResult=function(){return this._sortByScore()},new t}();t.onmessage=function(s){var n=s.data;"docs"==n.type?(e.initDocs(n.docs),t.postMessage({type:"ready"})):"search"==n.type&&(e.matchWords(n.words),t.postMessage({type:"result",result:e.getResult()}))},t.postMessage({type:"loaded"})}(self);