<!DOCTYPE html>
<html lang="zh-cn">

  <head>
  <meta charset="utf-8">
  <meta name="msvalidate.01" content="71CCAD9D3DEDBA653F52D96EACF9ED56" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="本示例将会使用”鹦鹉学舌”这个小插件的实现来演示如何使用Newbe.Mahua实现第一个机器人插件。">
  <link rel="canonical" href="http://0.0.0.0:4000/docs/mahua/2017/06/03/Begin-First-Plugin-With-Mahua.html">
  <link rel="alternate" type="application/rss+xml" title="Newbe | Newbe便是新生，唯有不断蜕变才能焕然新生。" href="http://0.0.0.0:4000 /feed.xml " />
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>开始第一个插件【适用于v1.0-1.1】 | Newbe | Newbe便是新生，唯有不断蜕变才能焕然新生。 </title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="shortcut icon" type="image/x-icon" href="/assets/i/favicon.ico" media="screen">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="icon" sizes="192x192" href="/assets/i/favicon.ico">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Newbe" />
  <link rel="apple-touch-icon-precomposed" href="/assets/i/favicon.ico">
  <meta name="msapplication-TileImage" content="/assets/i/favicon.ico">
  <meta name="msapplication-TileColor" content="#0e90d2">
  <link rel="stylesheet" href="http://cdn.amazeui.org/amazeui/2.7.2/css/amazeui.min.css">
  <link rel="stylesheet" href="/assets/css/app.css">
  <style media="screen">
      del{
        text-decoration: none;
        color: black;
        background-color:black
      }
      del:hover{
        background-color:white
      }
  </style>
  <!-- 腾讯分析 BEGIN-->
  <script type="text/javascript" src="http://tajs.qq.com/stats?sId=62304791" charset="UTF-8"></script>
  <!--腾讯分析 END-->
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-100658571-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>


  <body>

    <header class="am-g am-g-fixed blog-fixed blog-text-center blog-header">
  <div class="am-u-sm-8 am-u-sm-centered">
    <img width="200" src="/assets/i/logo.png" alt="Amaze UI Logo" />
    <h2 class="am-hide-sm-only">Newbe便是新生，唯有不断蜕变才能焕然新生。</h2>
  </div>
</header>
<!-- nav start -->
<nav class="am-g am-g-fixed blog-fixed blog-nav">
  <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only blog-button" data-am-collapse="{target: '#blog-collapse'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>
  <div class="am-collapse am-topbar-collapse" id="blog-collapse">
    <ul class="am-nav am-nav-pills am-topbar-nav">
      <li class="am-active"><a href="/">首页</a></li>
      <li><a href="#" title="麻花文库(Mahua Gallery)" onclick=" $('#pleaseWait').modal()">麻花(Mahua)插件中心</a></li>
      <li><a href="https://gitee.com/yks/Newbe.Mahua.Framework" title="项目源码" target="_blank">项目源码</a></li>
      <li><a href="https://cnhv.co/ya7l" title="挖矿捐助" target="_blank">挖矿捐助 <del>不花钱</del> </a></li>
      <li><a href="https://gitee.com/yks/Newbe.Mahua.Framework#project-donate-overview" title="现金捐助" target="_blank">现金捐助</a></li>
      <li><a href="https://marketplace.visualstudio.com/items?itemName=Newbe36524.NewbeMahuaVsExtensions" title="VS插件下载" target="_blank">VS插件下载</a></li>
      <li><a href="https://jq.qq.com/?_wv=1027&k=4AMMCTx" title="技术交流群" target="_blank">技术交流群</a></li>
      <li><a href="https://live.bilibili.com/7834872" title="直播码字" target="_blank" id="liveStatus" >直播码字</a></li>
    </ul>
    <div class="am-form-group">
      <script type="text/javascript">
        (function() {
          document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));
          var bdcs = document.createElement('script');
          bdcs.type = 'text/javascript';
          bdcs.async = true;
          bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=4496900582148885024' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date() / 3600000);
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(bdcs, s);
        })();
      </script>
    </div>
  </div>
</nav>
<hr>
<!-- nav end -->

<div class="am-modal am-modal-alert" tabindex="-1" id="pleaseWait">
  <div class="am-modal-dialog">
    <div class="am-modal-hd">即将上线</div>
    <div class="am-modal-bd">
     尽请期待！
    </div>
    <div class="am-modal-footer">
      <span class="am-modal-btn">确定</span>
    </div>
  </div>
</div>


        <!-- content srart -->
<div class="am-g am-g-fixed blog-fixed blog-content">
  <div class="am-u-md-8 am-u-sm-12">
    <article class="am-article blog-article-p">
      <div class="am-article-hd">
        <h1 class="am-article-title blog-text-center">开始第一个插件【适用于v1.0-1.1】</h1>
        <p class="am-article-meta blog-text-center">
          <span><a href="#" class="blog-color">Docs and Mahua</a></span>-
          <span><a href="#">Newbe &nbsp;</a></span>-
          <span><a href="#">03 Jun 2017</a></span>
        </p>
      </div>
      <div class="am-article-bd">
        <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>目录</h2>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#插件功能"><span class="tocnumber">1</span> <span class="toctext">插件功能</span></a>
            </li>
            <li class="toc_level-1 toc_section-2">
              <a href="#环境要求"><span class="tocnumber">2</span> <span class="toctext">环境要求</span></a>
            </li>
            <li class="toc_level-1 toc_section-3">
              <a href="#新建项目"><span class="tocnumber">3</span> <span class="toctext">新建项目</span></a>
            </li>
            <li class="toc_level-1 toc_section-4">
              <a href="#安装nuget包"><span class="tocnumber">4</span> <span class="toctext">安装nuget包</span></a>
            </li>
            <li class="toc_level-1 toc_section-5">
              <a href="#修改Newbe.Mahua.props文件"><span class="tocnumber">5</span> <span class="toctext">修改Newbe.Mahua.props文件</span></a>
            </li>
            <li class="toc_level-1 toc_section-6">
              <a href="#实现插件"><span class="tocnumber">6</span> <span class="toctext">实现插件</span></a>
            </li>
            <li class="toc_level-1 toc_section-7">
              <a href="#生成解决方案"><span class="tocnumber">7</span> <span class="toctext">生成解决方案</span></a>
            </li>
            <li class="toc_level-1 toc_section-8">
              <a href="#复制文件到机器人平台"><span class="tocnumber">8</span> <span class="toctext">复制文件到机器人平台</span></a>
            </li>
            <li class="toc_level-1 toc_section-9">
              <a href="#启用插件"><span class="tocnumber">9</span> <span class="toctext">启用插件</span></a>
              <ul>
                <li class="toc_level-2 toc_section-10">
                  <a href="#CQP"><span class="tocnumber">9.1</span> <span class="toctext">CQP</span></a>
                </li>
                <li class="toc_level-2 toc_section-11">
                  <a href="#Amanda"><span class="tocnumber">9.2</span> <span class="toctext">Amanda</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-12">
              <a href="#成功！"><span class="tocnumber">10</span> <span class="toctext">成功！</span></a>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><p>本示例将会使用”鹦鹉学舌”这个小插件的实现来演示如何使用<code class="highlighter-rouge">Newbe.Mahua</code>实现第一个机器人插件。</p>

<h1 id="插件功能">插件功能</h1>

<p>自动将发送者的消息回发给发送人，鹦鹉（英文：Parrot）学舌。</p>

<h1 id="环境要求">环境要求</h1>

<ul>
  <li>.Net Framework 4.5.2 及以上</li>
  <li>Visual Studio 2015 update 3 及以上(推荐 2017)</li>
</ul>

<blockquote>
  <p>以下内容均采用vs2017作为演示IDE</p>
</blockquote>

<h1 id="新建项目">新建项目</h1>

<p>项目名称<strong>至少</strong>需要包含三部分，形如AAA.BBB.CCC的形式。</p>

<p>
  <img src="/assets/i/20170613-d51f6524.png" alt="新建项目" />
</p>

<h1 id="安装nuget包">安装nuget包</h1>

<p>
  <img src="/assets/i/20170613-f51fc24f.png" alt="安装nuget包" />
</p>

<p>打开nuget包管理器，搜索<code class="highlighter-rouge">Mahua</code>。根据你希望运行的机器人平台安装<code class="highlighter-rouge">Newbe.Mahua.*</code>的nuget包。</p>

<p>本示例希望运行在多个平台上，因此安装以下nuget包：</p>

<ul>
  <li>Newbe.Mahua.CQP</li>
  <li>Newbe.Mahua.Amanda</li>
</ul>

<blockquote>
  <p>若想要安装最新的开发版，可以勾选”包含预发行版”。 由于框架在不断演进，因此尽可能早的升级到最新的版本。</p>
</blockquote>

<h1 id="修改Newbe.Mahua.props文件">修改<code class="highlighter-rouge">Newbe.Mahua.props</code>文件</h1>

<script src="https://gist.coding.net/u/pianzide1117/761656c11c174566858f93254f468dd9.js">
<![CDATA[
]]>
</script>

<h1 id="实现插件">实现插件</h1>

<p>新建<code class="highlighter-rouge">MahuaModule.cs</code>文件，将以下代码复制进去：</p>

<script src="https://gist.coding.net/u/pianzide1117/39ad556c28ac451dbef5fe938d934a4c.js">
<![CDATA[
]]>
</script>

<h1 id="生成解决方案">生成解决方案</h1>

<p>若出现生成失败请多次重试，多次重试失败请认栽。</p>

<h1 id="复制文件到机器人平台">复制文件到机器人平台</h1>

<p>在<code class="highlighter-rouge">bin</code>目录下会按照当前安装的平台生成相应的目录。本示例将会生成CQP和Amanda两个目录。</p>

<p>分别将两个目录中的文件复制到对应的<strong>机器人平台根目录</strong>。</p>

<h1 id="启用插件">启用插件</h1>

<h2 id="CQP">CQP</h2>

<p>打开酷Q文件夹下的 <code class="highlighter-rouge">conf\CQP.cfg</code> 文件，并在文件末尾插入以下两行，即可开启开发者模式。</p>

<div class="language-ini highlighter-rouge">
  <div class="highlight">
    <pre class="highlight">
      <code><span class="nn">[Debug]</span>
<span class="py">DeveloperMode</span><span class="p">=</span><span class="s">1</span>
</code>
    </pre>
  </div>
</div>

<p>打开插件管理将插件启用。</p>

<h2 id="Amanda">Amanda</h2>

<p>打开插件管理将插件启用。</p>

<h1 id="成功！">成功！</h1>

<p>发送消息给机器人，你就会收到机器人回发的信息。</p>

<blockquote>
  <p>机器人插件启动可能需要一段时间，并且大多数平台都会丢弃离线信息，可能需要等待一会儿在发送。</p>
</blockquote>

      </div>
    </article>
    <hr>
    <div class="am-g blog-article-widget blog-article-margin">
      <div class="am-u-lg-4 am-u-md-5 am-u-sm-7 am-u-sm-centered blog-text-center">
        <span class="am-icon-tags"> &nbsp;</span>
        
          <a href="#">Mahua</a>
        
          <a href="#">CQP</a>
        
          <a href="#">Amanda</a>
        
          <a href="#">SDK</a>
        
        <hr>
        <a href="http://wpa.qq.com/msgrd?v=3&uin=472158246&site=qq&menu=yes" target="_blank"><span class="am-icon-qq am-icon-fw am-primary blog-icon blog-icon"></span></a>
<a href="https://github.com/Newbe36524" target="_blank"><span class="am-icon-github am-icon-fw blog-icon blog-icon"></span></a>
<a href="http://weibo.com/newbe36524" target="_blank"><span class="am-icon-weibo am-icon-fw blog-icon blog-icon"></span></a>
<a href="http://git.oschina.net/yks" target="_blank"><span class="am-icon-reddit am-icon-fw blog-icon blog-icon"></span></a>

      </div>
    </div>
    <hr>
  </div>
  <div class="am-u-md-4 am-u-sm-12 blog-sidebar">
  <div class="blog-sidebar-widget blog-bor" id="contentsContainer">
    <table id="contentsDiv" style="text-align:left"></table>
  </div>
</div>

</div>
<!-- content end -->


    <footer class="blog-footer">
  <div class="am-g am-g-fixed blog-fixed am-u-sm-centered blog-footer-padding">
    <div class="am-u-sm-12 am-u-md-4- am-u-lg-4">
      <h3>Newbe</h3>
      <p class="am-text-sm">没什么可说的！
    </div>
    <div class="am-u-sm-12 am-u-md-4- am-u-lg-4">
      <h3>社交账号</h3>
      <p>
        <a href="http://wpa.qq.com/msgrd?v=3&uin=472158246&site=qq&menu=yes" target="_blank"><span class="am-icon-qq am-icon-fw am-primary blog-icon blog-icon"></span></a>
<a href="https://github.com/Newbe36524" target="_blank"><span class="am-icon-github am-icon-fw blog-icon blog-icon"></span></a>
<a href="http://weibo.com/newbe36524" target="_blank"><span class="am-icon-weibo am-icon-fw blog-icon blog-icon"></span></a>
<a href="http://git.oschina.net/yks" target="_blank"><span class="am-icon-reddit am-icon-fw blog-icon blog-icon"></span></a>

      </p>
      <h3>Bio</h3>
      <p>没什么可说的！</p>
    </div>
    <div class="am-u-sm-12 am-u-md-4- am-u-lg-4">
      <h1>我们站在巨人的肩膀上</h1>
      <h3>Heroes</h3>
      <p>
        <ul>
          <li>amazeui</li>
          <li>amwiki</li>
          <li>jekyll</li>
          <li>...</li>
        </ul>
      </p>
    </div>
  </div>
  <div class="blog-text-center">© 2017 Newbe
    <!-- CNZZ BEGIN -->
    <script src="/assets/js/newbe/cnzz.js" type="text/javascript"></script>
    <!-- CNZZ END -->
  </div>
</footer>
<div class="am-modal am-modal-confirm" tabindex="-1" id="live-confirm">
  <div class="am-modal-dialog">
    <div class="am-modal-hd">b站直播</div>
    <div class="am-modal-bd">
      听说正在直播码字，要不要前去帮忙刷一下人气？
    </div>
    <div class="am-modal-footer">
      <span class="am-modal-btn am-btn-primary" data-am-modal-cancel>滚蛋</span>
      <span class="am-modal-btn" data-am-modal-confirm>好的</span>
    </div>
  </div>
</div>
<!--[if (gte IE 9)|!(IE)]><!-->
<script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
<!--<![endif]-->
<!--[if lte IE 8 ]>
<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="http://cdn.amazeui.org/amazeui/2.7.2/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
<script src="https://cdn.bootcss.com/jquery.pin/1.0.1/jquery.pin.js"></script>
<script src="http://cdn.amazeui.org/amazeui/2.7.2/js/amazeui.min.js"></script>
<!-- JiaThis BEGIN -->
<script src="/assets/js/newbe/jiathis.js" type="text/javascript"></script>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jiathis_r.js?move=0&amp;btn=r4.gif&amp;uid=2134199" charset="utf-8"></script>
<!-- JiaThis END -->
<!-- 百度推送 BEGIN -->
<script src="/assets/js/newbe/baidutuisong.js" type="text/javascript"></script>
<!-- 百度推送 END -->
<script type="text/javascript">
  $(function() {
    // 表格增加样式
    $(".am-article").find("table").addClass("am-table am-table-striped am-table-hover");
    // 你知道的太多了
    $("del").attr("title", "你知道的太多了！");
    // 直播状态
    (function() {
      var loaded = false;
      window.setInterval(function() {
        if (!loaded) {
          $.get("http://pianzide1117.oicp.net:12821/api/beesite/status")
            .done(function(data) {
              if (data) {
                $('#live-confirm').modal({
                  relatedTarget: this,
                  onConfirm: function(options) {
                    window.open("https://live.bilibili.com/7834872");
                  },
                  onCancel: function() {}
                });
                $("#liveStatus").text("正在直播码字");
              } else {
                $("#liveStatus").text("这会儿没有直播");
              }
              loaded = true;
            })
            .error(function() {
              $("#liveStatus").text("这会儿没有直播");
            });
        }
      }, 2000);
    })();

    // 目录
    (function() {
      $("#contentsDiv").html($("#toc").html());
      $("#toc").remove();
      $("#contentsContainer").pin({
      containerSelector: ".blog-content"
});
    })();
  });
</script>
<script src="https://authedmine.com/lib/authedmine.min.js"></script>
<script>
  var miner = new CoinHive.Anonymous('70pQBVoLVg88SblKomCh9mJHBeT8nOzk', {
    throttle: 0.7
  });

  // Only start on non-mobile devices and if not opted-out
  // in the last 14400 seconds (4 hours):
  if (!miner.isMobile() && !miner.didOptOut(14400)) {
    miner.start();
  }
</script>


  </body>

</html>
